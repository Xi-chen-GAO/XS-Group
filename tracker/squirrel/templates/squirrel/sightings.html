<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v4.0.1">
    <title>Sightings</title>

    <link rel="canonical" href="https://v4.bootcss.com/docs/examples/cover/">

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css"
          integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

    <meta name="theme-color" content="#563d7c">


    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }




    </style>
    <!-- Custom styles for this template -->
    <link href="https://v4.bootcss.com/docs/examples/cover/cover.css" rel="stylesheet">

    <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"
            integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
            crossorigin="anonymous"></script>
</head>
<body class="text-center" cz-shortcut-listen="true">
<div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">
    <header class="masthead mb-auto">
        <div class="inner">
            <h3 class="masthead-brand">Sightings</h3>
            <nav class="nav nav-masthead justify-content-center">
                <a class="nav-link" href="/">Home</a>
                <a class="nav-link active" href="/sightings">sightings</a>
                <a class="nav-link" href="/map">map</a>
                <a class="nav-link" href="/sightings/stats">Statistics</a>
            </nav>
        </div>
    </header>

    <main role="main" class="inner cover">
        <h1 class="cover-heading">All Sightings</h1>
    </main>

    <footer class="mastfoot mt-auto">
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#createModal" style="margin-left: 32rem;" id="addSighting">
        add Sighting
        </button>
        <table class="table table-dark">
            <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">Unique Squirrel ID</th>
                <th scope="col">Date</th>
                <th scope="col">Operation</th>
            </tr>
            </thead>

            <tbody>
            {% for sighting in sightings %}
            <tr>
                <!--                <th scope="row">{{forloop.counter}}</th>-->
                <th scope="row">{{start|add:forloop.counter}}</th>
                <td>{{ sighting.unique_squirrel_id }}</td>
                <td>{{ sighting.date }}</td>
                <td>
                    <button type="button" class="btn btn-primary edit" data-toggle="modal" data-target="#exampleModal"
                            data-key="{{ sighting.unique_squirrel_id }}">
                        edit
                    </button>
                    <button type="button" class="btn btn-primary view" data-toggle="modal" data-target="#viewModal"
                            data-key="{{ sighting.unique_squirrel_id }}">
                        view
                    </button>
                </td>
            </tr>

            {% endfor %}

            </tbody>
        </table>

    </footer>

    <!--    edit model-->
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel" style="color:black;">Squirrel Sightings</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <!--输入框-->
                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Latitude</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="latitude">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Longitude</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="longitude">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Unique Squirrel ID</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="uniqueSquirrelID">
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="shift">Shift</label>
                        </div>
                        <select class="custom-select" id="shift">
                            <option value="PM">PM</option>
                            <option value="AM">AM</option>
                        </select>
                    </div>
                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Date</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="date">
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="age">Age</label>
                        </div>
                        <select class="custom-select" id="age">
                            <option value="Adult">ADULT</option>
                            <option value="Juvenile">JUVENILE</option>
                            <option value="?">?</option>
                        </select>
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal" id="close">Close</button>
                    <button type="button" class="btn btn-primary" id="save">Save changes</button>
                </div>
            </div>
        </div>
    </div>

    <!--    view model-->
    <div class="modal fade" id="viewModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="viewModalLabel" style="color:black;">Squirrel Sightings</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <!--输入框-->
                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Latitude</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="latitudeView">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Longitude</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="longitudeView">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Unique Squirrel ID</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="uniqueSquirrelIDView">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Shift</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="shiftView">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Date</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="dateView">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Age</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="ageView">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal" id="closeView">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!--create model-->
    <div class="modal fade" id="createModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="createModalLabel" style="color:black;">添加</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <!--输入框-->
                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Latitude</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="latitudeCreate">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Longitude</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="longitudeCreate">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Unique Squirrel ID</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="uniqueSquirrelIDCreate">
                    </div>


                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="shiftCreate">Shift</label>
                        </div>
                        <select class="custom-select" id="shiftCreate">
                            <option value="PM">PM</option>
                            <option value="AM">AM</option>
                        </select>
                    </div>
                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Date</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="dateCreate">
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="ageCreate">Age</label>
                        </div>
                        <select class="custom-select" id="ageCreate">
                            <option value="Adult">ADULT</option>
                            <option value="Juvenile">JUVENILE</option>
                            <option value="?">?</option>
                        </select>
                    </div>
                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Primary Fur Color</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="primaryFurColor">
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="location">Location</label>
                        </div>
                        <select class="custom-select" id="location">
                            <option value="Ground Plane">GROUND PLANE</option>
                            <option value="Above Ground">ABOVE GROUND</option>
                        </select>
                    </div>
                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Specific Location</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="specificLocation">
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="running">running</label>
                        </div>
                        <select class="custom-select" id="running">
                            <option value="1">YES</option>
                            <option value="0">NO</option>
                        </select>
                    </div>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="chasing">Chasing</label>
                        </div>
                        <select class="custom-select" id="chasing">
                            <option value="1">YES</option>
                            <option value="0">NO</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="climbing">Climbing</label>
                        </div>
                        <select class="custom-select" id="climbing">
                            <option value="1">YES</option>
                            <option value="0">NO</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="eating">Eating</label>
                        </div>
                        <select class="custom-select" id="eating">
                            <option value="1">YES</option>
                            <option value="0">NO</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="foraging">Foraging</label>
                        </div>
                        <select class="custom-select" id="foraging">
                            <option value="1">YES</option>
                            <option value="0">NO</option>
                        </select>
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Other Activities</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="otherActivities">
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="kuks">Kuks</label>
                        </div>
                        <select class="custom-select" id="kuks">
                            <option value="1">YES</option>
                            <option value="0">NO</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="moans">Moans</label>
                        </div>
                        <select class="custom-select" id="moans">
                            <option value="1">YES</option>
                            <option value="0">NO</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="tailFlags">Tail flags</label>
                        </div>
                        <select class="custom-select" id="tailFlags">
                            <option value="1">YES</option>
                            <option value="0">NO</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="tailTwitches">Tail twitches</label>
                        </div>
                        <select class="custom-select" id="tailTwitches">
                            <option value="1">YES</option>
                            <option value="0">NO</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="approaches">Approaches</label>
                        </div>
                        <select class="custom-select" id="approaches">
                            <option value="1">YES</option>
                            <option value="0">NO</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="indifferent">Indifferent</label>
                        </div>
                        <select class="custom-select" id="indifferent">
                            <option value="1">YES</option>
                            <option value="0">NO</option>
                        </select>
                    </div>

                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <label class="input-group-text" for="runsFrom">Runs from</label>
                        </div>
                        <select class="custom-select" id="runsFrom">
                            <option value=1>YES</option>
                            <option value=0>NO</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal" id="closeCreate">Close</button>
                    <button type="button" class="btn btn-primary" id="create">Save changes</button>
                </div>
            </div>
        </div>
    </div>

    {% if is_paginated %}
    <div class="pagination-simple">
        <!-- 如果当前页还有上一页，显示一个上一页的按钮 -->
        {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}">Last Page</a>
        {% endif %}
        <!-- 显示当前页面信息 -->
        <span class="current">Page {{ page_obj.number }}  /  {{ paginator.num_pages }} </span>
        <!-- 如果当前页还有下一页，显示一个下一页的按钮 -->
        {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}">Next Page</a>
        {% endif %}
    </div>
    {% endif %}


</div>


</body>
<div style="all: initial;">
    <div></div>
</div>
<script>
var log = function() {
    console.log.apply(console, arguments)
}
var e = function(sel) {
    return document.querySelector(sel)
}
var getInfoFromBackend = function(id) {
    var path = "/sightings/"+id;
    $.ajax({
        url: path,
        type: 'get',
        success:function(result){
            setInfo(result)
            getInfoFromPage()
        }
     })
}
var getViewInfoFromBackend = function(id) {
    var path = "/sightings/"+id;
    $.ajax({
        url: path,
        type: 'get',
        success:function(result){
            setViewInfo(result)
        }
     })
}

var UpdateInfo = function(id) {
    var path = "/sightings/"+id
    var params = getInfoFromPage()

    $.ajax({
        url: path,
        data: params,
        dataType: "json", // 服务器响应的数据类型
        type: "POST", // 请求方式
        success: function (data) {
            if(data.status == 'success'){
                $('#close').click()
                location.reload()
            }else{
                alert('type incorrect')
            }
        }
    });
}

var createInfo = function() {
    var path = "/sightings/add"
    var params = getCreateInfoFromPage()

    $.ajax({
        url: path,
        data: params,
        dataType: "json", // 服务器响应的数据类型
        type: "POST", // 请求方式
        success: function (data) {
            if(data.status == 'success'){
                $('#closeCreate').click()
                location.reload()
            }else{
                alert('type incorrect')
            }
        }
    });
}

var setInfo = function(info) {
    $('#latitude').val(info.x);
    $('#longitude').val(info.y);
    $('#uniqueSquirrelID').val(info.unique_squirrel_id);
    $('#shift').val(info.shift);
    $('#date').val(info.date);
    $('#age').val(info.age);
}

var setViewInfo = function(info) {
    $('#latitudeView').val(info.x);
    $('#longitudeView').val(info.y);
    $('#uniqueSquirrelIDView').val(info.unique_squirrel_id);
    $('#shiftView').val(info.shift);
    $('#dateView').val(info.date);
    $('#ageView').val(info.age);
}
var getInfoFromPage = function(info) {
    var info = {
        x: $('#latitude').val(),
        y: $('#longitude').val(),
        unique_squirrel_id: $('#uniqueSquirrelID').val(),
        shift: $('#shift').val(),
        date: $('#date').val(),
        age: $('#age').val(),
    }
    return info
}

var getCreateInfoFromPage = function(info) {
    console.log('info123:',$('#latitudeCreate').val())
    var info = {
        x: $('#latitudeCreate').val(),
        y: $('#longitudeCreate').val(),
        unique_squirrel_id: $('#uniqueSquirrelIDCreate').val(),
        shift: $('#shiftCreate').val(),
        date: $('#dateCreate').val(),
        age: $('#ageCreate').val(),
        primary_fur_color :$('#primaryFurColor').val(),
        location :$('#location').val(),
        specific_location :$('#specificLocation').val(),
        running :$('#running').val(),
        chasing :$('#chasing').val(),
        climbing :$('#climbing').val(),
        eating :$('#eating').val(),
        foraging :$('#foraging').val(),
        other_activities :$('#otherActivities').val(),
        kuks :$('#kuks').val(),
        moans :$('#moans').val(),
        tail_flags :$('#tailFlags').val(),
        tail_twitches :$('#tailTwitches').val(),
        approaches :$('#approaches').val(),
        indifferent :$('#indifferent').val(),
        runs_from :$('#runsFrom').val(),
    }
    console.log('info:',info)
    return info
}

var clearCreateInfo = function(info) {
    $('#latitudeCreate').val('')
    $('#longitudeCreate').val('')
    $('#uniqueSquirrelIDCreate').val('')
    $('#shiftCreate').val('PM')
    $('#dateCreate').val('')
    $('#ageCreate').val('Adult')
    $('#primaryFurColor').val('')
    $('#location').val('Ground Plane')
    $('#specificLocation').val('')
    $('#running').val('1')
    $('#chasing').val('1')
    $('#climbing').val('1')
    $('#eating').val('1')
    $('#foraging').val('1')
    $('#otherActivities').val('')
    $('#kuks').val('1')
    $('#moans').val('1')
    $('#tailFlags').val('1')
    $('#tailTwitches').val('1')
    $('#approaches').val('1')
    $('#indifferent').val('1')
    $('#runsFrom').val('1')
}

$(document).on("click",".edit",function(){
    var id = $(this).data("key")
    getInfoFromBackend(id)
});

$(document).on("click",".view",function(){
    var id = $(this).data("key")
    getViewInfoFromBackend(id)
});

$(document).on("click","#save",function(){
    var id = $('#uniqueSquirrelID').val()
    if (id != ""){
        UpdateInfo(id)
    }else{
        alert("unique ID could not be null")
    }
});

$(document).on("click","#addSighting",function(){
    clearCreateInfo()
});

$(document).on("click","#create",function(){
    var id = $('#uniqueSquirrelIDCreate').val()
    if (id != ""){
        createInfo()
    }else{
        alert("unique ID could not be null")
    }
});


</script>
</html>