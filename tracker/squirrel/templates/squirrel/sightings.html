<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Jekyll v4.0.1">
    <title>Sightings</title>

    <link rel="canonical" href="https://v4.bootcss.com/docs/examples/cover/">

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/css/bootstrap.min.css"
          integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

    <meta name="theme-color" content="#563d7c">


    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }

    </style>
    <!-- Custom styles for this template -->
    <link href="https://v4.bootcss.com/docs/examples/cover/cover.css" rel="stylesheet">

    <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.0/dist/js/bootstrap.min.js"
            integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
            crossorigin="anonymous"></script>
</head>
<body class="text-center" cz-shortcut-listen="true">
<div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">
    <header class="masthead mb-auto">
        <div class="inner">
            <h3 class="masthead-brand">Sightings</h3>
            <nav class="nav nav-masthead justify-content-center">
                <!--                <buttontton type="button" class="btn btn-primary">add Sighting</buttontton>-->
                <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#createModal" id="addSighting">
                    add Sighting
                </button>
                <!--                <a class="nav-link active">add Sighting</a>-->
                <!--                <a class="nav-link" href="https://v4.bootcss.com/docs/examples/cover/#">Features</a>-->
                <!--                <a class="nav-link" href="https://v4.bootcss.com/docs/examples/cover/#">Contact</a>-->
            </nav>
        </div>
    </header>

    <main role="main" class="inner cover">
        <h1 class="cover-heading">All Sightings</h1>
        <p class="lead">some thing to say</p>
    </main>

    <footer class="mastfoot mt-auto">
        <table class="table table-dark">
            <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">Unique Squirrel ID</th>
                <th scope="col">Date</th>
                <th scope="col">Operation</th>
            </tr>
            </thead>

            <tbody>
            {% for sighting in sightings %}
            <tr>
                <th scope="row">{{forloop.counter}}</th>
                <td>{{ sighting.unique_squirrel_id }}</td>
                <td>{{ sighting.date }}</td>
                <td>
                    <button type="button" class="btn btn-primary edit" data-toggle="modal" data-target="#exampleModal"
                            data-key="{{ sighting.unique_squirrel_id }}">
                        edit
                    </button>
                </td>
            </tr>

            {% endfor %}

            </tbody>
        </table>

    </footer>

    <!--    edit model-->
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel" style="color:black;">松鼠详情</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <!--输入框-->
                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Latitude</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="latitude">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Longitude</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="longitude">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Unique Squirrel ID</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="uniqueSquirrelID">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Shift</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="shift">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Date</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="date">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Age</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="age">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal" id="close">Close</button>
                    <button type="button" class="btn btn-primary" id="save">Save changes</button>
                </div>
            </div>
        </div>
    </div>

    <!--create model-->
    <div class="modal fade" id="createModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="createModalLabel" style="color:black;">添加</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <!--输入框-->
                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Latitude</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="latitudeCreate">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Longitude</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="longitudeCreate">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Unique Squirrel ID</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="uniqueSquirrelIDCreate">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Shift</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="shiftCreate">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Date</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="dateCreate">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Age</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="ageCreate">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Primary Fur Color</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="primaryFurColor">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Location</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="location">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Specific Location</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="specificLocation">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Running</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="running">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Chasing</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="chasing">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Climbing</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="climbing">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Eating</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="eating">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Foraging</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="foraging">
                    </div>


                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Other Activities</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="otherActivities">
                    </div>


                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Kuks</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="kuks">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Moans</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="moans">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Tail flags</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="tailFlags">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Tail twitches</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="tailTwitches">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Approaches</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="approaches">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Indifferent</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm"
                               id="indifferent">
                    </div>

                    <div class="input-group input-group-sm mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text">Runs from</span>
                        </div>
                        <input type="text" class="form-control" aria-describedby="inputGroup-sizing-sm" id="runsFrom">
                    </div>

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal" id="closeCreate">Close</button>
                    <button type="button" class="btn btn-primary" id="create">Save changes</button>
                </div>
            </div>
        </div>
    </div>
</div>


</body>
<div style="all: initial;">
    <div></div>
</div>
<script>
var log = function() {
    console.log.apply(console, arguments)
}
var e = function(sel) {
    return document.querySelector(sel)
}
var getInfoFromBackend = function(id) {
    var path = "/sightings/"+id;
    $.ajax({
        url: path,
        type: 'get',
        success:function(result){
            setInfo(result)
            getInfoFromPage()
        }
     })
}

var UpdateInfo = function(id) {
    var path = "/sightings/"+id
    var params = getInfoFromPage()

    $.ajax({
        url: path,
        data: params,
        dataType: "json", // 服务器响应的数据类型
        type: "POST", // 请求方式
        success: function (data) {
            if(data.status == 'success'){
                $('#close').click()
                location.reload()
            }
        }
    });
}

var createInfo = function() {
    var path = "/sightings/add"
    var params = getCreateInfoFromPage()

    $.ajax({
        url: path,
        data: params,
        dataType: "json", // 服务器响应的数据类型
        type: "POST", // 请求方式
        success: function (data) {
            if(data.status == 'success'){
                $('#closeCreate').click()
                location.reload()
            }
        }
    });
}

var setInfo = function(info) {
    $('#latitude').val(info.x);
    $('#longitude').val(info.y);
    $('#uniqueSquirrelID').val(info.unique_squirrel_id);
    $('#shift').val(info.shift);
    $('#date').val(info.date);
    $('#age').val(info.age);
}

var getInfoFromPage = function(info) {
    var info = {
        x: $('#latitude').val(),
        y: $('#longitude').val(),
        unique_squirrel_id: $('#uniqueSquirrelID').val(),
        shift: $('#shift').val(),
        date: $('#date').val(),
        age: $('#age').val(),
    }
    return info
}

var getCreateInfoFromPage = function(info) {
    var info = {
        x: $('#latitudeCreate').val(),
        y: $('#longitudeCreate').val(),
        unique_squirrel_id: $('#uniqueSquirrelIDCreate').val(),
        shift: $('#shiftCreate').val(),
        date: $('#dateCreate').val(),
        age: $('#ageCreate').val(),
        primary_fur_color :$('primaryFurColor').val(),
        location :$('location').val(),
        specific_location :$('specificLocation').val(),
        running :$('running').val(),
        chasing :$('chasing').val(),
        climbing :$('climbing').val(),
        eating :$('eating').val(),
        foraging :$('foraging').val(),
        other_activities :$('otherActivities').val(),
        kuks :$('kuks').val(),
        moans :$('moans').val(),
        tail_flags :$('tailFlags').val(),
        tail_twitches :$('tailTwitches').val(),
        approaches :$('approaches').val(),
        indifferent :$('indifferent').val(),
        runs_from :$('runsFrom').val(),
    }
    return info
}

var clearCreateInfo = function(info) {
    $('#latitudeCreate').val('')
    $('#longitudeCreate').val('')
    $('#uniqueSquirrelIDCreate').val('')
    $('#shiftCreate').val('')
    $('#dateCreate').val('')
    $('#ageCreate').val('')
    $('primaryFurColor').val('')
    $('location').val('')
    $('specificLocation').val('')
    $('running').val('')
    $('chasing').val('')
    $('climbing').val('')
    $('eating').val('')
    $('foraging').val('')
    $('otherActivities').val('')
    $('kuks').val('')
    $('moans').val('')
    $('tailFlags').val('')
    $('tailTwitches').val('')
    $('approaches').val('')
    $('indifferent').val('')
    $('runsFrom').val('')
}

$(document).on("click",".edit",function(){
    var id = $(this).data("key")
    getInfoFromBackend(id)
});

$(document).on("click","#save",function(){
    var id = $('#uniqueSquirrelID').val()
    UpdateInfo(id)
});

$(document).on("click","#addSighting",function(){
    clearCreateInfo()
});

$(document).on("click","#create",function(){
    clearCreateInfo()
    createInfo()
});


</script>
</html>